
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Lift and Reflection - Christian Oestreich</title>
  <meta name="author" content="Christian Oestreich">

  
  <meta name="description" content="So here is some really dumb Scala and Lift code that does a bit of validation.
The only thing I really wanted to do when I wrote this code was to see &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.christianoestreich.com/2010/10/lift-reflection/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ctoestreich" rel="alternate" title="Christian Oestreich" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8726967-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Christian Oestreich</a></h1>
  <h2><a class="brand" href="http://www.twoguysindesign.com" style="color:#9ed846;text-decoration: none;"><i class="fa fa-male fa-border"></i>&nbsp;<i class="fa fa-male fa-border"></i>&nbsp;&nbsp;two guys in design</a> - software.development.professional</h2>

  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ctoestreich" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.christianoestreich.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">Blog</a></li>
    <li><a href="/blog/archives">Archives</a></li>
    <li><a href="/blog/categories/grails/index.html">Grails</a></li>
    <li><a href="/blog/categories/groovy/index.html">Groovy</a></li>
    <li><a href="/blog/categories/javascript/index.html">JavaScript</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Lift and Reflection</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-10-05T13:54:10+00:00" pubdate data-updated="true">Oct 5<span>th</span>, 2010</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>So here is some really dumb Scala and Lift code that does a bit of validation.
The only thing I really wanted to do when I wrote this code was to see how I
could use reflection and a Map to drive validation since our main project does
something similar (albeit more well configured) in Java.Â  There is some other
code mixed in when I was playing with the dispatch stuff that isn&rsquo;t currently
hooked up.</p>

<p>The reflection and adding the error class to the map is done in this method.
Note that the setAccessible(true) was the key for me to get this working as it
was puking all over the place with out that line in there.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">validateFields</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">requiredFields</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">field</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">f</span> <span class="k">=</span> <span class="n">getClass</span><span class="o">.</span><span class="n">getDeclaredField</span><span class="o">(</span><span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">f</span><span class="o">.</span><span class="n">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">S</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="n">field</span> <span class="o">+</span> <span class="s">&quot;Field&quot;</span><span class="o">,</span> <span class="s">&quot;You need to provide a &quot;</span> <span class="o">+</span> <span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">+=</span> <span class="n">field</span> <span class="o">-&gt;</span> <span class="s">&quot;error&quot;</span>
</span><span class='line'> <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">-=</span> <span class="n">field</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">})</span>
</span><span class='line'> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is the full code for reference.</p>

<p>Xhtml Code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">surround</span> <span class="kt">with</span><span class="o">=</span><span class="s">&quot;default&quot;</span> <span class="n">at</span><span class="o">=</span><span class="s">&quot;content&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">lift</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">hello</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">v</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">RentingForm.rent</span> <span class="kt">form</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;confirmform&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">legend</span><span class="o">&gt;</span><span class="nc">Video</span> <span class="nc">Hire</span> <span class="nc">Details</span><span class="o">&lt;/</span><span class="n">legend</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="n">u</span><span class="o">&gt;</span><span class="n">N</span><span class="o">&lt;/</span><span class="n">u</span><span class="o">&gt;</span><span class="n">ame</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">name/&gt;&amp;nbsp</span><span class="o">;&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">Msg</span> <span class="kt">id</span><span class="o">=</span><span class="s">&quot;nameField&quot;</span> <span class="n">errorClass</span><span class="o">=</span><span class="s">&quot;errortext&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;address&quot;</span><span class="o">&gt;</span><span class="nc">Address</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">textbox</span> <span class="kt">name</span><span class="o">=</span><span class="s">&quot;addressVO&quot;</span> <span class="n">property</span><span class="o">=</span><span class="s">&quot;address1&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="o">&gt;</span><span class="nc">Email</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">email/&gt;&amp;nbsp</span><span class="o">;&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">Msg</span> <span class="kt">id</span><span class="o">=</span><span class="s">&quot;emailField&quot;</span> <span class="n">errorClass</span><span class="o">=</span><span class="s">&quot;errortext&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;movietype&quot;</span><span class="o">&gt;</span><span class="nc">Movie</span> <span class="nc">Type</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">movie/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;dateOfHire&quot;</span><span class="o">&gt;</span><span class="nc">Date</span> <span class="n">of</span> <span class="nc">Hire</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">date/&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;notify&quot;</span><span class="o">&gt;</span> <span class="nc">DD</span><span class="o">/</span><span class="nc">MM</span><span class="o">/</span><span class="nc">YYYY</span> <span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;numberOfDays&quot;</span><span class="o">&gt;</span><span class="nc">Number</span> <span class="nc">Of</span> <span class="nc">Days</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">numberOfDays/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">legend</span><span class="o">&gt;&lt;</span><span class="n">span</span><span class="o">&gt;</span> <span class="nc">Discount</span> <span class="nc">Rate</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">legend</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">regular/&gt;&lt;label&gt;</span> <span class="kt">&lt;v:rtxt1/&gt;</span> <span class="kt">&lt;/label&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">new/&gt;</span> <span class="kt">&lt;label&gt;</span> <span class="kt">&lt;v:rtxt2/&gt;</span> <span class="kt">&lt;/label&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;btn&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">submit/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">lift</span><span class="k">:</span><span class="kt">RentingForm.rent&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">lift</span><span class="k">:</span><span class="kt">surround&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Snippet Code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">demo.helloworld.snippet</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.jquery.JqJsCmds.DisplayMessage</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.JsCmds.SetHtml</span>
</span><span class='line'><span class="k">import</span> <span class="nn">S._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">SHtml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.util._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">Helpers._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">scala.xml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http.js._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.common.</span><span class="o">{</span><span class="nc">Empty</span><span class="o">,</span> <span class="nc">Logger</span><span class="o">,</span> <span class="nc">Full</span><span class="o">}</span>
</span><span class='line'><span class="k">import</span> <span class="nn">java.lang.String</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="k">class</span> <span class="nc">RentingForm</span> <span class="k">extends</span> <span class="nc">StatefulSnippet</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">dispatch</span><span class="k">:</span> <span class="kt">DispatchIt</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">case</span> <span class="s">&quot;rent&quot;</span> <span class="k">=&gt;</span> <span class="n">rentForm</span> <span class="k">_</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">var</span> <span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">movieType</span><span class="o">,</span> <span class="n">dateOfHire</span><span class="o">,</span> <span class="n">numberOfDays</span><span class="o">,</span> <span class="n">discount</span><span class="o">)</span><span class="k">=</span> <span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">movieMap</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">&quot;&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Select Movie Type&quot;</span><span class="o">,</span> <span class="s">&quot;Sci-fi&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Sci-fi&quot;</span><span class="o">,</span><span class="s">&quot;Horror&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Horror&quot;</span><span class="o">,</span> <span class="s">&quot;Comedy&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Comedy&quot;</span><span class="o">,</span> <span class="s">&quot;Suspense&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Suspense&quot;</span><span class="o">,</span><span class="s">&quot;Romance&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Romance&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">discountMap</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;Regular Customer&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Regular Customer&quot;</span><span class="o">,</span> <span class="s">&quot;New Customer&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;New Customer&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">val</span> <span class="n">discounts</span> <span class="k">=</span> <span class="n">radio</span><span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">toList</span><span class="o">,</span> <span class="nc">Full</span><span class="o">(</span><span class="n">discount</span><span class="o">),</span> <span class="n">discount</span> <span class="k">=_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;required&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">fieldClass</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">.</span><span class="n">empty</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span>
</span><span class='line'> <span class="k">var</span> <span class="n">requiredFields</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;email&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">def</span> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">,</span> <span class="n">discounts</span><span class="k">:</span> <span class="kt">SHtml.ChoiceHolder</span><span class="o">[</span><span class="kt">String</span><span class="o">],</span><span class="n">submitLabel</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">val</span> <span class="n">requiredClass</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;required&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="n">bind</span><span class="o">(</span><span class="s">&quot;v&quot;</span><span class="o">,</span> <span class="n">xhtml</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">name</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span> <span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span><span class="n">requiredClass</span><span class="o">),</span> <span class="s">&quot;accesskey&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;N&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;address&quot;</span> <span class="o">-&gt;</span> <span class="n">textarea</span><span class="o">(</span><span class="n">address</span><span class="o">,</span> <span class="n">address</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;rows&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;5&quot;</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;address&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;email&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">email</span><span class="o">,</span> <span class="n">email</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;{</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;email&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; email&quot;</span><span class="o">}),</span>
</span><span class='line'> <span class="s">&quot;movie&quot;</span> <span class="o">-&gt;</span> <span class="n">select</span><span class="o">(</span><span class="n">movieMap</span><span class="o">,</span> <span class="nc">Empty</span><span class="o">,</span> <span class="n">movieType</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;movieMap&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;date&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">dateOfHire</span><span class="o">,</span> <span class="n">dateOfHire</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;{</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;dateOfHire&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; date&quot;</span><span class="o">},</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;datePicker&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;numberOfDays&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">numberOfDays</span><span class="o">,</span> <span class="n">numberOfDays</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;numberOfDays&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">),</span> <span class="s">&quot;onkeypress&quot;</span> <span class="o">-&gt;</span><span class="s">&quot;checkNumerics(event)&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;regular&quot;</span> <span class="o">-&gt;</span> <span class="n">discounts</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;new&quot;</span> <span class="o">-&gt;</span> <span class="n">discounts</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;rtxt1&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;Regular Customer&quot;</span><span class="o">,</span> <span class="s">&quot;No Key!&quot;</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;rtxt2&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;New Customer&quot;</span><span class="o">,</span> <span class="s">&quot;No Key!&quot;</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;submit&quot;</span> <span class="o">-&gt;</span> <span class="n">submit</span><span class="o">(</span><span class="n">submitLabel</span><span class="o">,</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="o">{},</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;submit&quot;</span><span class="o">))</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">rentForm</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">dispatch</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">case</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="k">=&gt;</span> <span class="n">showDetails</span> <span class="k">_</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="o">,</span> <span class="n">discounts</span><span class="o">,</span> <span class="s">&quot;Confirm&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">validateFields</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">requiredFields</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">field</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">f</span> <span class="k">=</span> <span class="n">getClass</span><span class="o">.</span><span class="n">getDeclaredField</span><span class="o">(</span><span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">f</span><span class="o">.</span><span class="n">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">S</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="n">field</span> <span class="o">+</span> <span class="s">&quot;Field&quot;</span><span class="o">,</span> <span class="s">&quot;You need to provide a &quot;</span> <span class="o">+</span> <span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">+=</span> <span class="n">field</span> <span class="o">-&gt;</span> <span class="s">&quot;error&quot;</span>
</span><span class='line'> <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">-=</span> <span class="n">field</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">})</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">showDetails</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">validateFields</span>
</span><span class='line'> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="o">,</span> <span class="n">discounts</span><span class="o">,</span> <span class="s">&quot;Edit&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">thankYou</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="nc">Log</span><span class="o">.</span><span class="n">info</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">movieType</span><span class="o">,</span> <span class="n">dateOfHire</span><span class="o">,</span> <span class="n">numberOfDays</span><span class="o">,</span><span class="n">discount</span><span class="o">)</span>
</span><span class='line'> <span class="n">bind</span><span class="o">(</span><span class="s">&quot;v&quot;</span><span class="o">,</span> <span class="n">xhtml</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">name</span><span class="o">))</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">ctoestreich</span></span>

      








  


<time datetime="2010-10-05T13:54:10+00:00" pubdate data-updated="true">Oct 5<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/technology/'>Technology</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.christianoestreich.com/2010/10/lift-reflection/" data-via="ctoestreich" data-counturl="http://www.christianoestreich.com/2010/10/lift-reflection/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/2010/09/play-framework-code/" title="Previous Post: Play!(ing) with some code">&laquo; Play!(ing) with some code</a>
      
      
        <a class="basic-alignment right articlenav" href="/2010/10/lift-beans-lists-oh-my/" title="Next Post: Lift & Beans & Lists... OH MY!">Lift & Beans & Lists... OH MY! &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/12/knockout-validation-rules-engine/">Knockout Validation Rules Engine</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/grails-plugin-template-override/">Grails Plugin Template Override</a>
      </li>
    
      <li class="post">
        <a href="/2013/05/travis-ci-grails-gvm/">Travis CI & Grails GVM</a>
      </li>
    
      <li class="post">
        <a href="/2013/01/wss4j-simple-security-using-wslite/">WSS4J Simple Security Using Groovy WSLite</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/coffeescript-ant-task-updated/">CoffeeScript Ant Task Updated</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/ctoestreich">@ctoestreich</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'ctoestreich',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>

</section>




<section>
  <h1>GitHub Repos</h1>
  <ul id="gh2_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/Grails-Plugin-Consortium">@Grails-Plugin-Consortium</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Grails-Plugin-Consortium',
            count: 10,
            skip_forks: true,
            target: '#gh2_repos'
        });
    });
  </script>
</section>


  <script src="/javascripts/github.js" type="text/javascript"> </script>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Christian Oestreich -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'christianoestreich';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.christianoestreich.com/2010/10/lift-reflection/';
        var disqus_url = 'http://www.christianoestreich.com/2010/10/lift-reflection/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
