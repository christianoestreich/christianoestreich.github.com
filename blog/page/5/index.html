
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Christian Oestreich</title>
  <meta name="author" content="Christian Oestreich">

  
  <meta name="description" content="Recently at work I was seeing a pattern with JavaScript that was causing me a
little concern. Every time someone wanted to do an ajax call on an &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.christianoestreich.com/blog/page/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ctoestreich" rel="alternate" title="Christian Oestreich" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8726967-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Christian Oestreich</a></h1>
  <h2><a class="brand" href="http://www.twoguysindesign.com" style="color:#9ed846;text-decoration: none;"><i class="fa fa-male fa-border"></i>&nbsp;<i class="fa fa-male fa-border"></i>&nbsp;&nbsp;two guys in design</a> - software.development.professional</h2>

  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ctoestreich" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.christianoestreich.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">Blog</a></li>
    <li><a href="/blog/archives">Archives</a></li>
    <li><a href="/blog/categories/grails/index.html">Grails</a></li>
    <li><a href="/blog/categories/groovy/index.html">Groovy</a></li>
    <li><a href="/blog/categories/javascript/index.html">JavaScript</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2011/03/exploring-jquery-ui-widgets/">Exploring jQuery UI Widgets</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2011-03-07T08:39:03+00:00" pubdate data-updated="true">Mar 7<span>th</span>, 2011</time>
        
         | <a href="/2011/03/exploring-jquery-ui-widgets/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently at work I was seeing a pattern with JavaScript that was causing me a
little concern.  Every time someone wanted to do an ajax call on an object
they would write some code using jQuery to load up the object with every call.
The first attempt to correct this pattern was to create a reusable method that
we could invoke as needed.  We came up with the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getAjaxJson</span><span class="p">(</span><span class="nx">actionUrl</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">spinDiv</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">args</span><span class="p">)</span> <span class="o">?</span> <span class="p">{}</span> <span class="o">:</span> <span class="nx">args</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">spinDiv</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">cache</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">url</span><span class="o">:</span> <span class="nx">actionUrl</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">data</span><span class="o">:</span> <span class="nx">params</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">spinDiv</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">onError</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">args</span><span class="p">.</span><span class="nx">onError</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">spinDiv</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">onPostBack</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nx">args</span><span class="p">.</span><span class="nx">onPostBack</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was an okay approach and worked for quite a while but we were still
having to do things like this all over the site where we wanted to use this
method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">spinDiv</span> <span class="o">=</span> <span class="s1">&#39;ajax_spin&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">targetField</span> <span class="o">=</span> <span class="s1">&#39;someField&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">targetField</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="s2">&quot;foo=bar&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">actionUrl</span> <span class="o">=</span> <span class="s2">&quot;url/url.url&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">getAjaxJson</span><span class="p">(</span><span class="nx">actionUrl</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">spinDiv</span><span class="p">,</span> <span class="p">{</span><span class="nx">onPostBack</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="k">if</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">fullDescription</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">targetField</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">fullDescription</span><span class="p">);</span>
</span><span class='line'>   <span class="p">}</span>
</span><span class='line'><span class="p">}});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We went on for a year in happy bliss of our new &ldquo;easy&rdquo; approach to get ajax to
work with our site. None of us were really considered to be UI or UX experts
on the team and we just kept adding more and more JavaScript to set up ajax on
a component.</p>

<p>I started drinking the jQuery Kool-Aid a while back and was doing some
prototyping and trying to find more intricate solutions to help reduce the
amount of script we had littered across the site.  I had my ah-ha moment while
doing some research into the <a href="http://docs.jquery.com/UI_Developer_Guide#The_widget_factory" title="jQuery Widgets">jQuery Widget</a> framework.</p>

<p>I wanted to create a widget that would allow us to load content via ajax
without having to write a lot of additional script code.  I needed a way to be
able to indicate what url, params and target div to render the content to in
the event that we want the load of some thing to trigger ajax to be loaded
into another div.  To solve the first problem I started looking into is
jQuery&rsquo;s support of the HTML 5 <a href="http://api.jquery.com/data/" title="jQuery Data Attribute Support">data attributes</a>.</p>

<p>By adding items such as <div id="..." **data-controller**="..." **data-
params**="..." **data-action**="..." **data-target**="..." /> and using the
jQuery.attr(&ldquo;data-controller&rdquo;) I am able to retrieve the value.  We played
around with just using the jQuery.data(&ldquo;controller&rdquo;), but jQuery seemed to
only like to find the data-controller attribute when it was added via the
jQuery.data(&ldquo;controller&rdquo;,&ldquo;value&rdquo;) (This is something I want to play around
with more going forward).</p>

<p>The ui.lazyload.js Widget:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// no logging errors from ie6</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">clickName</span> <span class="o">=</span> <span class="s1">&#39;click.lazyload&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">window</span><span class="p">.</span><span class="nx">console</span> <span class="o">||</span> <span class="p">(</span><span class="nx">console</span> <span class="o">=</span> <span class="p">{},</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{});</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">widget</span><span class="p">(</span><span class="s2">&quot;ui.lazyload&quot;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="nx">ops</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>
</span><span class='line'>            <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">actn</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span><span class="p">(</span><span class="nx">url</span> <span class="o">&amp;&amp;</span> <span class="nx">actn</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nx">actn</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">args</span><span class="p">)</span> <span class="o">?</span> <span class="nx">actn</span> <span class="o">:</span> <span class="nx">actn</span> <span class="o">+</span> <span class="s2">&quot;&amp;&quot;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">;</span>
</span><span class='line'>                    <span class="nx">o</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nx">o</span><span class="p">)</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="nx">o</span> <span class="o">:</span> <span class="nx">o</span><span class="p">);</span>
</span><span class='line'>                    <span class="nx">$</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;loading...&quot;</span><span class="p">);</span>
</span><span class='line'>                    <span class="k">if</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">before</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">before</span><span class="p">))</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">before</span><span class="p">());</span>
</span><span class='line'>                    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>                        <span class="nx">url</span><span class="o">:</span> <span class="nx">url</span><span class="p">,</span>
</span><span class='line'>                        <span class="nx">cache</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>                        <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span>
</span><span class='line'>                        <span class="nx">data</span><span class="o">:</span> <span class="nx">actn</span><span class="p">,</span>
</span><span class='line'>                        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                            <span class="nx">$</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;Error processing request.&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">);</span>
</span><span class='line'>                            <span class="k">if</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">error</span><span class="p">))</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">error</span><span class="p">());</span>
</span><span class='line'>                        <span class="p">},</span>
</span><span class='line'>                        <span class="nx">complete</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
</span><span class='line'>                            <span class="k">if</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">complete</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">complete</span><span class="p">))</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">complete</span><span class="p">());</span>
</span><span class='line'>                        <span class="p">},</span>
</span><span class='line'>                        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                            <span class="nx">el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;lazy-load&quot;</span><span class="p">).</span><span class="nx">unbind</span><span class="p">(</span><span class="nx">clickName</span><span class="p">);</span>
</span><span class='line'>                            <span class="nx">$</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;.loading-img&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
</span><span class='line'>                            <span class="k">if</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">success</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">success</span><span class="p">))</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">ops</span><span class="p">.</span><span class="nx">success</span><span class="p">());</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                    <span class="p">});</span>
</span><span class='line'>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;You must provide a data-controller and a data-action on the object.&quot;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">})(</span><span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;data-target&quot;</span><span class="p">),</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;data-controller&quot;</span><span class="p">),</span> <span class="s2">&quot;action=&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;data-action&quot;</span><span class="p">),</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;data-params&quot;</span><span class="p">));</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">destroy</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="c1">// default destroy</span>
</span><span class='line'>            <span class="c1">// now do other stuff particular to this widget</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.lazy-load&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$</span><span class="p">(</span><span class="nx">sec</span><span class="p">).</span><span class="nx">lazyload</span><span class="p">();</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>This basically takes any item with a class of &ldquo;lazy-load&rdquo; and attempts to load
the content via ajax.  The only requirement is that you define the data
objects in the html tag such as the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;one&quot;</span> <span class="na">class=</span><span class="s">&quot;lazy-load&quot;</span>
</span><span class='line'>     <span class="na">data-controller=</span><span class="s">&quot;/url/url.url&quot;</span>
</span><span class='line'>     <span class="na">data-action=</span><span class="s">&quot;doWork&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;two&quot;</span>
</span><span class='line'>     <span class="na">data-controller=</span><span class="s">&quot;/url/url.url&quot;</span>
</span><span class='line'>     <span class="na">data-action=</span><span class="s">&quot;doMoreWork&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Since we use Spring MVC we are invoking our urls like the  following
/url/url.url?action=doWork.  This could all be combined into the data-
controller attribute, but for clarity of invocation we split them up as
separate items.  The target of &ldquo;this&rdquo; is assumed if the data-target isn&rsquo;t
provided.  If we needed to add params to the ajax call we could add a data-
params=&ldquo;foo=bar&rdquo; and the resulting url would be invoked as
/url/url.url?action=doWork&amp;foo=bar where foo=bar is passed to the jQuery ajax
method in the data parameter.</p>

<p>We modified our JSTL tags to take the 4 new params to set.  Getting content
wired up to load via ajax requires the users to no longer write any JavaScript
code, just simply define the parameters and invoke .lazyload().  Of course
there are special cases in which eventing is required so I went back and added
support for the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#one&quot;</span><span class="p">).</span><span class="nx">lazyload</span><span class="p">({</span><span class="nx">before</span><span class="o">:</span> <span class="p">[</span><span class="kd">function</span><span class="p">],</span> <span class="nx">complete</span><span class="o">:</span> <span class="p">[</span><span class="kd">function</span><span class="p">],</span> <span class="nx">success</span><span class="o">:</span> <span class="p">[</span><span class="kd">function</span><span class="p">],</span> <span class="nx">error</span><span class="o">:</span> <span class="p">[</span><span class="kd">function</span><span class="p">]});</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>before </strong>&ndash; execute the [function] before calling the ajax method on the
object <strong>complete </strong>&ndash; execute the [function] after calling the ajax method on
the object regardless of status <strong>success </strong>&ndash; execute the [function] after
calling the ajax method on the object on success <strong>error </strong>&ndash; execute the
[function] after calling the ajax method on the object on error</p>

<p>Also if people really want to customize how the item loads they could skip
adding the class of lazy-load and the ajax call will not happen on load.
Instead they can do something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#one&quot;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click.lazyload&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">).</span><span class="nx">lazyload</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This will bind a click event with a name-space of lazy-load (which will be
auto unbound after click via widget) to the object with id=&ldquo;one&rdquo;.  I wanted to
unbind the click event so I used the name-space, but if the user were to
simply bind(&lsquo;click&rsquo;,&hellip;); instead, it would not unbind the event and the ajax
would get invoked on every click.</p>

<p>When we are crossing multiple object boundaries and controls we have to be
conscious as to which object we add the data attributes to and which objects
have events that invoke the lazy-load.  The object with the .lazyload()
invoked must have the data attributes on it.  You can bind an even to another
object, but it will not get unbound unless you added support for that via the
complete event.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//Untested code</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#two&quot;</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click.lazyload&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">).</span><span class="nx">lazyload</span><span class="p">({</span><span class="nx">complete</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#two&quot;</span><span class="p">).</span><span class="nx">unbind</span><span class="p">(</span><span class="s1">&#39;click.lazyload&#39;</span><span class="p">);}});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>That code would lazy-load id=&ldquo;one&rdquo; when clicking on id=&ldquo;two&rdquo; and unbind the
click event after complete.  Perhaps using the before event would be better to
stop the multiple invocation of the ajax get.</p>

<p>I have learned a lot and am actively re-writing all our copy-paste JavaScript
where we do the same thing in multiple places.  I will post more as I create
them and hopefully they can be leveraged or rewritten to support your needs.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2010/10/lift-beans-lists-oh-my/">Lift & Beans & Lists&#8230; OH MY!</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-10-05T14:43:31+00:00" pubdate data-updated="true">Oct 5<span>th</span>, 2010</time>
        
         | <a href="/2010/10/lift-beans-lists-oh-my/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So during a recent exercise at work to prototype some currently functionality
from Java/JSP to Scala/Lift we needed to support loading some beans from the
spring context and support lists; two things that we were intimately familiar
with in Java but were lost in the weeds with in Lift.  We found that it was
relatively simple, but it took a while to come to that conclusion.  Here is
what we ended up doing.</p>

<p>First we created a helper class to load the context from Spring which turned
out to be as simple as the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">hsr.model</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http.</span><span class="o">{</span><span class="nc">LiftRules</span><span class="o">,</span> <span class="n">S</span><span class="o">,</span> <span class="nc">SHtml</span><span class="o">}</span>
</span><span class='line'><span class="k">import</span> <span class="nn">org.springframework.web.context.ContextLoader</span>
</span><span class='line'><span class="k">import</span> <span class="nn">com.demo.app.icue.helloworld.businesslogic.HelloWorld</span>
</span><span class='line'><span class="k">import</span> <span class="nn">com.demo.app.common.reference.businesslogic.Reference</span>
</span><span class='line'><span class="k">import</span> <span class="nn">org.springframework.validation.</span><span class="o">{</span><span class="nc">MapBindingResult</span><span class="o">,</span><span class="nc">BindingResult</span><span class="o">,</span><span class="nc">FieldError</span><span class="o">,</span><span class="nc">ObjectError</span><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Some utils for integrating Lift and Spring.</span>
</span><span class='line'><span class="cm"> * http://wordpress.rintcius.nl/post/a-recipe-to-integrate-lift-in-an-existing-spring-based-web-application</span>
</span><span class='line'><span class="cm"> * http://camel.465427.n5.nabble.com/Scala-and-Spring-config-td474898.html</span>
</span><span class='line'><span class="cm"> * http://berlinbrowndev.blogspot.com/2008/02/accessing-spring-framework-from-liftweb.html</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="k">object</span> <span class="nc">LiftUtils</span> <span class="o">{</span>
</span><span class='line'> <span class="k">val</span> <span class="n">context</span> <span class="k">=</span> <span class="nc">ContextLoader</span><span class="o">.</span><span class="n">getCurrentWebApplicationContext</span><span class="o">()</span>
</span><span class='line'> <span class="k">def</span> <span class="n">getHelloWorld</span><span class="k">:</span> <span class="kt">HelloWorld</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">getBean</span><span class="o">(</span><span class="s">&quot;com.demo.app.icue.helloworld.businesslogic.HelloWorld&quot;</span><span class="o">).</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">HelloWorld</span><span class="o">]</span>
</span><span class='line'> <span class="k">def</span> <span class="n">getReference</span><span class="k">:</span> <span class="kt">Reference</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">getBean</span><span class="o">(</span><span class="s">&quot;com.demo.app.common.reference.businesslogic.Reference&quot;</span><span class="o">).</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">Reference</span><span class="o">]</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The places we found some sample code from are listed in the object javadoc.
Essentially this is loading the [Class]Impl files from the spring context.  So
in this case it loads HelloWorldImpl and ReferenceImpl.</p>

<p>For the next set of code we have a method to turn the List<ReferenceCode> from
the ReferenceImpl into a Map so we can use it more efficiently in Scala.  We
first call the getReference and load up a list of pojo objects from the
database.  We then convert the list into buffer, convert the buffer to a list
and iterate over it and create a map that contains just the data we wanted for
our demonstration.  This code could certainly be condensed more.  We were
unsure when we wrote this prototype of going through the conversion of
Java.List &ndash;> Buffer &ndash;> Scala.List-> Map was the best approach for this, but it
worked and it served the purpose for the prototype and might be useful for
more people in the future.  Cheers!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">getReference</span><span class="o">(</span><span class="n">referenceName</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">val</span> <span class="n">values</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="nc">JavaConversions</span><span class="o">.</span><span class="n">asBuffer</span><span class="o">(</span><span class="nc">LiftUtils</span><span class="o">.</span><span class="n">getReference</span><span class="o">.</span><span class="n">list</span><span class="o">(</span><span class="n">referenceName</span><span class="o">))</span>
</span><span class='line'> <span class="n">values</span><span class="o">.</span><span class="n">toList</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">v</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="n">getReferenceCode</span><span class="o">,</span> <span class="n">v</span><span class="o">.</span><span class="n">getReferenceDesc</span><span class="o">))</span>
</span><span class='line'> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2010/10/lift-reflection/">Lift and Reflection</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-10-05T13:54:10+00:00" pubdate data-updated="true">Oct 5<span>th</span>, 2010</time>
        
         | <a href="/2010/10/lift-reflection/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So here is some really dumb Scala and Lift code that does a bit of validation.
The only thing I really wanted to do when I wrote this code was to see how I
could use reflection and a Map to drive validation since our main project does
something similar (albeit more well configured) in Java.  There is some other
code mixed in when I was playing with the dispatch stuff that isn&rsquo;t currently
hooked up.</p>

<p>The reflection and adding the error class to the map is done in this method.
Note that the setAccessible(true) was the key for me to get this working as it
was puking all over the place with out that line in there.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">validateFields</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">requiredFields</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">field</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">f</span> <span class="k">=</span> <span class="n">getClass</span><span class="o">.</span><span class="n">getDeclaredField</span><span class="o">(</span><span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">f</span><span class="o">.</span><span class="n">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">S</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="n">field</span> <span class="o">+</span> <span class="s">&quot;Field&quot;</span><span class="o">,</span> <span class="s">&quot;You need to provide a &quot;</span> <span class="o">+</span> <span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">+=</span> <span class="n">field</span> <span class="o">-&gt;</span> <span class="s">&quot;error&quot;</span>
</span><span class='line'> <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">-=</span> <span class="n">field</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">})</span>
</span><span class='line'> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is the full code for reference.</p>

<p>Xhtml Code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">surround</span> <span class="kt">with</span><span class="o">=</span><span class="s">&quot;default&quot;</span> <span class="n">at</span><span class="o">=</span><span class="s">&quot;content&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">lift</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">hello</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
</span><span class='line'><span class="n">xmlns</span><span class="k">:</span><span class="kt">v</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">RentingForm.rent</span> <span class="kt">form</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;confirmform&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">legend</span><span class="o">&gt;</span><span class="nc">Video</span> <span class="nc">Hire</span> <span class="nc">Details</span><span class="o">&lt;/</span><span class="n">legend</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="n">u</span><span class="o">&gt;</span><span class="n">N</span><span class="o">&lt;/</span><span class="n">u</span><span class="o">&gt;</span><span class="n">ame</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">name/&gt;&amp;nbsp</span><span class="o">;&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">Msg</span> <span class="kt">id</span><span class="o">=</span><span class="s">&quot;nameField&quot;</span> <span class="n">errorClass</span><span class="o">=</span><span class="s">&quot;errortext&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;address&quot;</span><span class="o">&gt;</span><span class="nc">Address</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">textbox</span> <span class="kt">name</span><span class="o">=</span><span class="s">&quot;addressVO&quot;</span> <span class="n">property</span><span class="o">=</span><span class="s">&quot;address1&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="o">&gt;</span><span class="nc">Email</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">email/&gt;&amp;nbsp</span><span class="o">;&lt;</span><span class="n">lift</span><span class="k">:</span><span class="kt">Msg</span> <span class="kt">id</span><span class="o">=</span><span class="s">&quot;emailField&quot;</span> <span class="n">errorClass</span><span class="o">=</span><span class="s">&quot;errortext&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;movietype&quot;</span><span class="o">&gt;</span><span class="nc">Movie</span> <span class="nc">Type</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">movie/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;dateOfHire&quot;</span><span class="o">&gt;</span><span class="nc">Date</span> <span class="n">of</span> <span class="nc">Hire</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">date/&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">span</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;notify&quot;</span><span class="o">&gt;</span> <span class="nc">DD</span><span class="o">/</span><span class="nc">MM</span><span class="o">/</span><span class="nc">YYYY</span> <span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s">&quot;numberOfDays&quot;</span><span class="o">&gt;</span><span class="nc">Number</span> <span class="nc">Of</span> <span class="nc">Days</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">numberOfDays/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">legend</span><span class="o">&gt;&lt;</span><span class="n">span</span><span class="o">&gt;</span> <span class="nc">Discount</span> <span class="nc">Rate</span><span class="o">:&lt;</span><span class="n">span</span><span class="o">&gt;*&lt;/</span><span class="n">span</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;&lt;/</span><span class="n">legend</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">regular/&gt;&lt;label&gt;</span> <span class="kt">&lt;v:rtxt1/&gt;</span> <span class="kt">&lt;/label&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">new/&gt;</span> <span class="kt">&lt;label&gt;</span> <span class="kt">&lt;v:rtxt2/&gt;</span> <span class="kt">&lt;/label&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;btn&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">v</span><span class="k">:</span><span class="kt">submit/&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">fieldset</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="n">lift</span><span class="k">:</span><span class="kt">RentingForm.rent&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">lift</span><span class="k">:</span><span class="kt">surround&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Snippet Code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">demo.helloworld.snippet</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.jquery.JqJsCmds.DisplayMessage</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.JsCmds.SetHtml</span>
</span><span class='line'><span class="k">import</span> <span class="nn">S._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">SHtml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.util._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">Helpers._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">scala.xml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http.js._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.common.</span><span class="o">{</span><span class="nc">Empty</span><span class="o">,</span> <span class="nc">Logger</span><span class="o">,</span> <span class="nc">Full</span><span class="o">}</span>
</span><span class='line'><span class="k">import</span> <span class="nn">java.lang.String</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="k">class</span> <span class="nc">RentingForm</span> <span class="k">extends</span> <span class="nc">StatefulSnippet</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">dispatch</span><span class="k">:</span> <span class="kt">DispatchIt</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">case</span> <span class="s">&quot;rent&quot;</span> <span class="k">=&gt;</span> <span class="n">rentForm</span> <span class="k">_</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">var</span> <span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">movieType</span><span class="o">,</span> <span class="n">dateOfHire</span><span class="o">,</span> <span class="n">numberOfDays</span><span class="o">,</span> <span class="n">discount</span><span class="o">)</span><span class="k">=</span> <span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">movieMap</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">&quot;&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Select Movie Type&quot;</span><span class="o">,</span> <span class="s">&quot;Sci-fi&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Sci-fi&quot;</span><span class="o">,</span><span class="s">&quot;Horror&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Horror&quot;</span><span class="o">,</span> <span class="s">&quot;Comedy&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Comedy&quot;</span><span class="o">,</span> <span class="s">&quot;Suspense&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Suspense&quot;</span><span class="o">,</span><span class="s">&quot;Romance&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Romance&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">discountMap</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;Regular Customer&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Regular Customer&quot;</span><span class="o">,</span> <span class="s">&quot;New Customer&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;New Customer&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">val</span> <span class="n">discounts</span> <span class="k">=</span> <span class="n">radio</span><span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">toList</span><span class="o">,</span> <span class="nc">Full</span><span class="o">(</span><span class="n">discount</span><span class="o">),</span> <span class="n">discount</span> <span class="k">=_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;required&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">var</span> <span class="n">fieldClass</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">.</span><span class="n">empty</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span>
</span><span class='line'> <span class="k">var</span> <span class="n">requiredFields</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;email&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="k">def</span> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">,</span> <span class="n">discounts</span><span class="k">:</span> <span class="kt">SHtml.ChoiceHolder</span><span class="o">[</span><span class="kt">String</span><span class="o">],</span><span class="n">submitLabel</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">val</span> <span class="n">requiredClass</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;required&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="n">bind</span><span class="o">(</span><span class="s">&quot;v&quot;</span><span class="o">,</span> <span class="n">xhtml</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">name</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span> <span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span><span class="n">requiredClass</span><span class="o">),</span> <span class="s">&quot;accesskey&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;N&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;address&quot;</span> <span class="o">-&gt;</span> <span class="n">textarea</span><span class="o">(</span><span class="n">address</span><span class="o">,</span> <span class="n">address</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;rows&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;5&quot;</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;address&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;email&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">email</span><span class="o">,</span> <span class="n">email</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;{</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;email&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; email&quot;</span><span class="o">}),</span>
</span><span class='line'> <span class="s">&quot;movie&quot;</span> <span class="o">-&gt;</span> <span class="n">select</span><span class="o">(</span><span class="n">movieMap</span><span class="o">,</span> <span class="nc">Empty</span><span class="o">,</span> <span class="n">movieType</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;movieMap&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;date&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">dateOfHire</span><span class="o">,</span> <span class="n">dateOfHire</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;{</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;dateOfHire&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; date&quot;</span><span class="o">},</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;datePicker&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;numberOfDays&quot;</span> <span class="o">-&gt;</span> <span class="n">text</span><span class="o">(</span><span class="n">numberOfDays</span><span class="o">,</span> <span class="n">numberOfDays</span> <span class="k">=</span> <span class="k">_</span><span class="o">,</span> <span class="s">&quot;class&quot;</span> <span class="o">-&gt;</span><span class="n">fieldClass</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;numberOfDays&quot;</span><span class="o">,</span> <span class="n">requiredClass</span><span class="o">),</span> <span class="s">&quot;onkeypress&quot;</span> <span class="o">-&gt;</span><span class="s">&quot;checkNumerics(event)&quot;</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;regular&quot;</span> <span class="o">-&gt;</span> <span class="n">discounts</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;new&quot;</span> <span class="o">-&gt;</span> <span class="n">discounts</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span>
</span><span class='line'> <span class="s">&quot;rtxt1&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;Regular Customer&quot;</span><span class="o">,</span> <span class="s">&quot;No Key!&quot;</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;rtxt2&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">discountMap</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;New Customer&quot;</span><span class="o">,</span> <span class="s">&quot;No Key!&quot;</span><span class="o">)),</span>
</span><span class='line'> <span class="s">&quot;submit&quot;</span> <span class="o">-&gt;</span> <span class="n">submit</span><span class="o">(</span><span class="n">submitLabel</span><span class="o">,</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="o">{},</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;submit&quot;</span><span class="o">))</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">rentForm</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">dispatch</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="k">case</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="k">=&gt;</span> <span class="n">showDetails</span> <span class="k">_</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="o">,</span> <span class="n">discounts</span><span class="o">,</span> <span class="s">&quot;Confirm&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">validateFields</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">requiredFields</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">field</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'> <span class="k">var</span> <span class="n">f</span> <span class="k">=</span> <span class="n">getClass</span><span class="o">.</span><span class="n">getDeclaredField</span><span class="o">(</span><span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">f</span><span class="o">.</span><span class="n">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</span><span class='line'> <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'> <span class="n">S</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="n">field</span> <span class="o">+</span> <span class="s">&quot;Field&quot;</span><span class="o">,</span> <span class="s">&quot;You need to provide a &quot;</span> <span class="o">+</span> <span class="n">field</span><span class="o">)</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">+=</span> <span class="n">field</span> <span class="o">-&gt;</span> <span class="s">&quot;error&quot;</span>
</span><span class='line'> <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'> <span class="n">fieldClass</span> <span class="o">-=</span> <span class="n">field</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'> <span class="o">})</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">showDetails</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">validateFields</span>
</span><span class='line'> <span class="n">bindFormFields</span><span class="o">(</span><span class="n">xhtml</span><span class="o">,</span> <span class="n">discounts</span><span class="o">,</span> <span class="s">&quot;Edit&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="n">thankYou</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="nc">Log</span><span class="o">.</span><span class="n">info</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">movieType</span><span class="o">,</span> <span class="n">dateOfHire</span><span class="o">,</span> <span class="n">numberOfDays</span><span class="o">,</span><span class="n">discount</span><span class="o">)</span>
</span><span class='line'> <span class="n">bind</span><span class="o">(</span><span class="s">&quot;v&quot;</span><span class="o">,</span> <span class="n">xhtml</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;name&quot;</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">name</span><span class="o">))</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2010/09/play-framework-code/">Play!(ing) With Some Code</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-09-15T18:14:03+00:00" pubdate data-updated="true">Sep 15<span>th</span>, 2010</time>
        
         | <a href="/2010/09/play-framework-code/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been doing some analysis on Lift and Scala.  I really like it
so far despite the drawbacks of poor code examples available online.  I also
have some personal projects that I am working on at home and wanted to expand
my knowledge of other frameworks so I decided to check out the <a href="http://www.playframework.org/" title="Play! Framework">Play! Framework</a>.</p>

<p>I ran through the <a href="http://www.playframework.org/documentation/1.1-trunk/home">Learn</a> link on the site for the new 1.1 framework.  It
got me up and running in no time flat.  I was able to see the default page in
a heart beat and it was very easy to go from zero to functional with minimal
setup.</p>

<p>The two things that I wanted to accomplish were to find a framework that was
easy to get running, that supported an MVC model and something with Scala
support.</p>

<p>As I am a re-convert back into Java after spending almost a decade doing
Microsoft development, I have really tried to immerse myself in more than just
plain vanilla Java development.  I have found Scala to be a breadth of fresh
air and a new challenge to help me dust off some of those idle brain cells.</p>

<p>To get Scala support with play you simply have to add the play (play.bat for
windows or play for mac) into your class path.  For the Mac you also need to
&ldquo;chmod -x play&rdquo; and &ldquo;chmod 775 play&rdquo; on the play file in there to make it
executable as well.</p>

<p><a href="http://build.christianoestreich.com/wp-content/uploads/2010/09/Screen-shot-2010-09-15-at-8.11.21-PM.png"><img src="http://build.christianoestreich.com/wp-content/uploads/2010/09/Screen-shot-2010-09-15-at-8.11.21-PM.png" title="Play! Framework Setup" alt="Play! Framework Setting Permissions Example Code" /></a></p>

<p>After setting up Scala and looking at their docs, I started to discover some
slight differences in what code is required to actually get their examples to
work.  For example their code had the following code to access a Jpa class
within a test.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">import</span> <span class="nn">models.User</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.scalatest.matchers.ShouldMatchers</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">play.test._</span>
</span><span class='line'>
</span><span class='line'><span class="kd">class</span> <span class="nc">SpecStyle</span> <span class="kd">extends</span> <span class="n">UnitFlatSpec</span> <span class="n">with</span> <span class="n">ShouldMatchers</span> <span class="o">{</span>
</span><span class='line'><span class="s">&quot;Creating a user&quot;</span> <span class="n">should</span> <span class="s">&quot;be succesfull&quot;</span> <span class="n">in</span> <span class="o">{</span>
</span><span class='line'> <span class="n">val</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&quot;bob@gmail.com&quot;</span><span class="o">,</span> <span class="s">&quot;secret&quot;</span><span class="o">,</span> <span class="s">&quot;Bob&quot;</span><span class="o">).</span><span class="na">save</span><span class="o">()</span>
</span><span class='line'> <span class="n">val</span> <span class="n">bob</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="s">&quot;byEmail&quot;</span><span class="o">,</span> <span class="s">&quot;bob@gmail.com&quot;</span><span class="o">).</span><span class="na">first</span>
</span><span class='line'> <span class="n">bob</span> <span class="n">should</span> <span class="n">not</span> <span class="nf">be</span> <span class="o">(</span><span class="kc">null</span><span class="o">)</span>
</span><span class='line'> <span class="n">bob</span><span class="o">.</span><span class="na">fullname</span> <span class="n">should</span> <span class="nf">be</span> <span class="o">(</span><span class="s">&quot;Bob&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I had to use the following to get the code to run.  I am not sure if I did
something wrong or of the example code was wrong but here is what I had to do
to get it working.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">import</span> <span class="nn">models.User</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.scalatest.matchers.ShouldMatchers</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">play.test._</span>
</span><span class='line'>
</span><span class='line'><span class="kd">class</span> <span class="nc">SpecStyle</span> <span class="kd">extends</span> <span class="n">UnitFlatSpec</span> <span class="n">with</span> <span class="n">ShouldMatchers</span> <span class="o">{</span>
</span><span class='line'><span class="s">&quot;Creating a user&quot;</span> <span class="n">should</span> <span class="s">&quot;be succesfull&quot;</span> <span class="n">in</span> <span class="o">{</span>
</span><span class='line'> <span class="n">val</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&quot;bob@gmail.com&quot;</span><span class="o">,</span> <span class="s">&quot;secret&quot;</span><span class="o">,</span> <span class="s">&quot;Bob&quot;</span><span class="o">).</span><span class="na">save</span><span class="o">()</span>
</span><span class='line'> <span class="n">val</span> <span class="n">bob</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="s">&quot;byEmail&quot;</span><span class="o">,</span> <span class="s">&quot;bob@gmail.com&quot;</span><span class="o">).</span><span class="na">first</span>
</span><span class='line'> <span class="n">bob</span> <span class="n">should</span> <span class="n">not</span> <span class="nf">be</span> <span class="o">(</span><span class="kc">null</span><span class="o">)</span>
</span><span class='line'> <span class="n">bob</span><span class="o">.</span><span class="na">get</span><span class="o">.</span><span class="na">fullname</span> <span class="n">should</span> <span class="nf">be</span> <span class="o">(</span><span class="s">&quot;Bob&quot;</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The only thing that is different is the fact that I had to call the get on
bob.get.fullname as calling bob.firstname wasn&rsquo;t getting me a User object that
I could check properties on.  If anyone has any ideas on this by all means let
me know.  Here is the user class/object.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">models</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">java.util._</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">play.db.jpa._</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">play.data.Validators._</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@Entity</span>
</span><span class='line'><span class="nd">@Table</span><span class="o">(</span><span class="n">uniqueConstraints</span><span class="o">=</span><span class="n">Array</span><span class="o">(</span><span class="k">new</span> <span class="n">UniqueConstraint</span><span class="o">(</span><span class="n">columnNames</span><span class="o">=</span><span class="n">Array</span><span class="o">(</span><span class="s">&quot;email&quot;</span><span class="o">))))</span>
</span><span class='line'><span class="kd">class</span> <span class="nf">User</span><span class="o">(</span>
</span><span class='line'> <span class="nd">@Email</span>
</span><span class='line'> <span class="nd">@Required</span>
</span><span class='line'> <span class="n">var</span> <span class="nl">email:</span> <span class="n">String</span><span class="o">,</span>
</span><span class='line'>
</span><span class='line'> <span class="nd">@Required</span>
</span><span class='line'> <span class="n">var</span> <span class="nl">password:</span> <span class="n">String</span><span class="o">,</span>
</span><span class='line'> <span class="n">var</span> <span class="nl">fullname:</span> <span class="n">String</span>
</span><span class='line'><span class="o">)</span> <span class="kd">extends</span> <span class="n">Model</span> <span class="o">{</span>
</span><span class='line'> <span class="n">var</span> <span class="n">isAdmin</span> <span class="o">=</span> <span class="kc">false</span>
</span><span class='line'> <span class="n">override</span> <span class="n">def</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">=</span> <span class="n">email</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">object</span> <span class="n">User</span> <span class="kd">extends</span> <span class="n">QueryOn</span><span class="o">[</span><span class="n">User</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'> <span class="n">def</span> <span class="nf">connect</span><span class="o">(</span><span class="nl">email:</span> <span class="n">String</span><span class="o">,</span> <span class="nl">password:</span> <span class="n">String</span><span class="o">)</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="n">find</span><span class="o">(</span><span class="s">&quot;byEmailAndPassword&quot;</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">password</span><span class="o">).</span><span class="na">first</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What I really love about the play framework is the integrated testing,
especially with Selenium, that comes for free with the framework.  More on
that to come soon.  I will post more code to get up and running, but the
sample code on the play site is very easy to get you up and running.</p>

<p>On a side note, I have been using my Mac more and more for development I
really like it now that I have a two button mouse&hellip; :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/2010/09/lift-me-up/">Lift Me Up</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-09-08T08:27:23+00:00" pubdate data-updated="true">Sep 8<span>th</span>, 2010</time>
        
         | <a href="/2010/09/lift-me-up/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been working on <a href="http://www.scala-lang.org" title="Scala">Scala</a> and <a href="http://www.liftweb.net" title="Liftweb">Lift</a> for a few weeks now and wanted
to post some of my code samples here and hopefully they are useful to someone
else in the future.</p>

<p>I would like to first say thank you to all those involved with developing and
creating the <a href="http://demo.liftweb.net" title="liftweb demos">liftweb demos</a>.  I know doing that can be a huge PITA, so
Thanks!  I would simply like to ask that future versions of demo code include
the html file code that produces the UI output.  Having only the backend code
causes a bit of stumbling.</p>

<p>The first examle I worked on was based on the Ajax
(<a href="http://demo.liftweb.net/ajax">http://demo.liftweb.net/ajax</a>) sample from liftweb.  Here is the code
below.</p>

<p>File: ajax.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;lift:surround</span> <span class="na">with=</span><span class="s">&quot;default&quot;</span> <span class="na">at=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
</span><span class='line'> <span class="nt">&lt;div&gt;</span>
</span><span class='line'> <span class="nt">&lt;lift:AjaxSample</span><span class="err">.</span><span class="na">sample</span><span class="nt">&gt;</span>
</span><span class='line'> <span class="nt">&lt;ajax:clicker&gt;</span>Click here to update count <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;cnt_id&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/span&gt;&lt;/ajax:clicker&gt;</span>
</span><span class='line'> <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
</span><span class='line'> <span class="nt">&lt;ajax:auto</span> <span class="na">limit=</span><span class="s">&quot;20&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'> <span class="err">&lt;</span>/lift:AjaxSample.sample&gt;
</span><span class='line'> <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/lift:surround&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>File: AjaxSample.scala</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.jquery.JqJsCmds.DisplayMessage</span>
</span><span class='line'><span class="k">import</span> <span class="nn">js.JsCmds.SetHtml</span>
</span><span class='line'><span class="k">import</span> <span class="nn">S._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">SHtml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.util._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">Helpers._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">scala.xml._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.http.js._</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.common.</span><span class="o">{</span><span class="nc">Empty</span><span class="o">,</span> <span class="nc">Logger</span><span class="o">,</span> <span class="nc">Full</span><span class="o">}</span>
</span><span class='line'><span class="k">import</span> <span class="nn">java.lang.String</span>
</span><span class='line'><span class="k">import</span> <span class="nn">net.liftweb.widgets.autocomplete.AutoComplete</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">AjaxSample</span> <span class="o">{</span>
</span><span class='line'> <span class="k">def</span> <span class="n">sample</span><span class="o">(</span><span class="n">xhtml</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span><span class="k">:</span> <span class="kt">NodeSeq</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'> <span class="c1">// local state for the counter</span>
</span><span class='line'> <span class="k">var</span> <span class="n">cnt</span> <span class="k">=</span> <span class="mi">0</span>
</span><span class='line'> <span class="c1">// get the id of some elements to update</span>
</span><span class='line'> <span class="k">val</span> <span class="n">spanName</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">attr</span><span class="o">(</span><span class="s">&quot;id_name&quot;</span><span class="o">)</span> <span class="n">openOr</span> <span class="s">&quot;cnt_id&quot;</span>
</span><span class='line'> <span class="k">val</span> <span class="n">msgName</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">attr</span><span class="o">(</span><span class="s">&quot;id_msgs&quot;</span><span class="o">)</span> <span class="n">openOr</span> <span class="s">&quot;messages&quot;</span>
</span><span class='line'> <span class="c1">// build up an ajax &lt;a&gt; tag to increment the counter</span>
</span><span class='line'> <span class="k">def</span> <span class="n">doClicker</span><span class="o">(</span><span class="n">text</span><span class="k">:</span> <span class="kt">NodeSeq</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'> <span class="n">a</span><span class="o">(()</span> <span class="k">=&gt;</span> <span class="o">{</span><span class="n">cnt</span> <span class="k">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="nc">SetHtml</span><span class="o">(</span><span class="n">spanName</span><span class="o">,</span> <span class="nc">Text</span><span class="o">(</span> <span class="n">cnt</span><span class="o">.</span><span class="n">toString</span><span class="o">))},</span> <span class="n">text</span><span class="o">)</span>
</span><span class='line'> <span class="c1">// bind the view to the functionality</span>
</span><span class='line'> <span class="n">bind</span><span class="o">(</span><span class="s">&quot;ajax&quot;</span><span class="o">,</span> <span class="n">xhtml</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;clicker&quot;</span> <span class="o">-&gt;</span> <span class="n">doClicker</span> <span class="k">_</span><span class="o">,</span>
</span><span class='line'> <span class="s">&quot;auto&quot;</span> <span class="o">-&gt;</span> <span class="nc">AutoComplete</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">,</span> <span class="n">buildQuery</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">()))</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'> <span class="k">private</span> <span class="k">def</span> <span class="n">buildQuery</span><span class="o">(</span><span class="n">current</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">limit</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'> <span class="nc">Log</span><span class="o">.</span><span class="n">info</span><span class="o">(</span><span class="s">&quot;Checking on server side with &quot;</span><span class="o">+</span><span class="n">current</span><span class="o">+</span><span class="s">&quot; limit &quot;</span><span class="o">+</span><span class="n">limit</span><span class="o">)</span>
</span><span class='line'> <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="n">limit</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">n</span> <span class="k">=&gt;</span> <span class="n">current</span><span class="o">+</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="n">n</span><span class="o">)</span>
</span><span class='line'> <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>All that this example does is simply do the a href tag ajax click to increment
the number and builds a autocomplete box that will simply show 10 of whatever
text you are typing retrieved via ajax of course.</p>

<p>I will keep putting my code samples up here as I create them.</p>

<p>Cheers</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/12/knockout-validation-rules-engine/">Knockout Validation Rules Engine</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/grails-plugin-template-override/">Grails Plugin Template Override</a>
      </li>
    
      <li class="post">
        <a href="/2013/05/travis-ci-grails-gvm/">Travis CI & Grails GVM</a>
      </li>
    
      <li class="post">
        <a href="/2013/01/wss4j-simple-security-using-wslite/">WSS4J Simple Security Using Groovy WSLite</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/coffeescript-ant-task-updated/">CoffeeScript Ant Task Updated</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/ctoestreich">@ctoestreich</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'ctoestreich',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>

</section>




<section>
  <h1>GitHub Repos</h1>
  <ul id="gh2_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/Grails-Plugin-Consortium">@Grails-Plugin-Consortium</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Grails-Plugin-Consortium',
            count: 10,
            skip_forks: true,
            target: '#gh2_repos'
        });
    });
  </script>
</section>


  <script src="/javascripts/github.js" type="text/javascript"> </script>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Christian Oestreich -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'christianoestreich';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
